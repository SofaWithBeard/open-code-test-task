# Драйвер бесколлекторного мотора с гальванической развязкой
## Входные данные для проектирования
Необходимо разработать схему для уравления мотором по следующим тербования:
* мотор - T-MOTOR MT 3515-15 400KV 
* управляющий контроллер - STM32F405RGT6
* управление должно осуществляться при помощи интерфейса USB или с помощью ШИМ.

Из [технических характеристик](http://www.himodel.com/m/electric/T-Motor_MT3515_400KV_Outrunner_Brushless_Motor_for_Multi-copter_3-8S.html) определяем, что:
* максимальный ток составляет 30 А
* напряжение питания выбираем равным 18,5 В, что соответствует 5ти ячейкам литиевых батарей с номинальным напряжением 3,7 В

## Выбор основной элементной базы и структуры устройства
При выборе элементной базы и определении структуры устройства будем исходить из того, что данный модуль при выходе из строя ремонту подлежать не будет, а производится полная его замена.
Таким образом гальваническая развязка будет осуществляться между внешними интерфейсами управления и контроллером в устройстве.

В качестве устройств для гальванической развязки выберем [ADuM3160](https://static.chipdip.ru/lib/009/DOC004009573.pdf) для интерфейса USB и [ADUM1400](https://static.chipdip.ru/lib/011/DOC004011682.pdf) для управления с помощью ШИМ сигнала. В слечае, когда подключены оба интерфейса, чтобы мажоритировать источник управления, на разъём ШИМ управления выведен дополнительный сигнал - в высоком его состоянии управление происходит посредством ШИМ, в низком - USB. По умолчанию со стороны драйвера этот сигнал имеет низкий уровень посредством подтяжки внутри микроконтроллера.

Для реализации мостовой схемы выберем транзистор [P0603BD](https://datasheetspdf.com/pdf-file/1094331/UNIKC/P0603BD/1) в следствии его большой нагрузочной способности и малого сопротивления открытого канала.

## Управление бесколлекторным двигателем
Управление осуществляется при помощи поочерёдного переключения обмоток ротора посредством полного моста на транзисторах.

Для эффективного управление трехфазным бесколлекторным двигателем необходима синхронизация управляющих воздействий и положения ротора. Для реализации используется эффект Back-EMF (за основу взят материал [отсюда](https://www.nxp.com/docs/en/application-note/AN1914.pdf)). Метод заключается в том, чтобы использовать незадействованную обмотру как индуктивный датчик. При переходе взаимного расположения статора и ротора через точку нуля, в которой напряжение, снимаемое с обмотки, будет равно половине питающего напряжения, происходит переключение моста. Это происходит до тех пор, пока не будет установлено целевое значение частоты вращения двигателя.